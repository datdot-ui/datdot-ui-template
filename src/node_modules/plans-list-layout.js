const bel = require('bel')
const csjs = require('csjs-inject')
const path = require('path')
const filename = path.basename(__filename)
const layout = require('layout')
const button = require('datdot-ui-button')
const svg = require('datdot-ui-graphic')

module.exports = plansList

function plansList ({page}, protocol) {
    const send2Parent = protocol( createNewPlanReceive )
    const iconCreate = svg({css: `${css.icon} ${css.create}`, path: '../node_modules/datdot-ui-graphic/assets/plus.svg'})
    const createButton = button({page, name: 'create', content: iconCreate, style: 'solid', color: 'dark', disabled: false}, createNewPlanProtocol('create-new-plan'))
    const section = layout({layoutName: 'plans', layoutStyle: css.plansList, content: bel`<div>${createButton}</div>`})
    
    send2Parent({page, from: 'plans-list', type: 'ready', filename, line: 15})
    
    return section
}

function createNewPlanProtocol(name) {
    return send => {
        return createNewPlanReceive
    }
}

function createNewPlanReceive (message) {
    const { page, from, flow, type, action, body, filename, line } = message
    console.log(message );
    if (type === 'click') console.log( `create new plan in line ${line} `)
}

const css = csjs`
.plansList {}
.icon {}
.create {}
`